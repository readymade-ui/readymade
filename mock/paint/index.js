var counter=function(t){"use strict";function e(t,e,n,o){var s,r=arguments.length,i=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(i=(r<3?s(i):r>3?s(e,n,i):s(e,n))||i);return r>3&&i&&Object.defineProperty(e,n,i),i}const n=/\[(\w+)\]/g,o=/^\./,s=/\{\{(\s*)(.*?)(\s*)\}\}/g,r=new RegExp("\\[","gi"),i=new RegExp("\\]","gi"),a="node __state",c="handler __state",u=function(t,e){const s=(e=(e=e.replace(n,".$1")).replace(o,"")).split(".");for(let e=0,n=s.length;e<n;++e){const n=s[e];if(!(n in t))return;t=t[n]}return t};class l{constructor(t){this.$flatMap={},this.$parent=t,this.$flatMap={},this.$parentId=function(){let t="";const e="abcdefghijklmnopqrstuvwxyz";for(;t.length<3;)t+=e[Math.floor(Math.random()*e.length)];return t}()}setNode(t,e,n){const o=this.$parentId+"-"+"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(24)})).slice(0,6),s=t.cloneNode(!0);t.setAttribute||(t.setAttribute=function(t,e){}),t.setAttribute(o,""),s.setAttribute||(s.setAttribute=function(t,e){}),s.setAttribute(o,""),this.$flatMap[o]||(this.$flatMap[o]={id:o,node:s},e&&n&&this.updateNode(t,e,n)),t.$init=!0}changeNode(t,e,n){e=(e=e.replace(r,"\\[")).replace(i,"\\]");const o=new RegExp(`{{(s*)(${e})(s*)}}`,"gi"),a=this.getElementByAttribute(t)[0].nodeName||this.getElementByAttribute(t)[0].name,c=this.$flatMap[a].node;if(c.textContent.match(o)&&(t.textContent=c.textContent.replace(o,n)),1===c.attributes.length)return;let u;for(const e of c.attributes){if(u=e.nodeName||e.name,u.includes("attr.")&&!c.getAttribute(u.replace("attr.",""))){e.nodeName?u=e.nodeName.replace("attr.",""):e.name&&(u=e.name.replace("attr.","")),c.setAttribute||(c.setAttribute=function(t,e){}),c.setAttribute(u,e.nodeValue.replace(s,""));const n=e.nodeName||e.name;t.removeAttribute(n)}const r=e.nodeValue||e.value;r.match(o,"gi")&&(t.setAttribute||(t.setAttribute=function(t,e){}),t.setAttribute(u,r.replace(o,n)));const i=e.nodeName||e.name;i.includes("attr.")&&t.removeAttribute(i)}}updateNode(t,e,n){var o;if(0!==this.getElementByAttribute(t).length)if(Array.isArray(n))for(let o=0;o<n.length;o++)this.changeNode(t,`${e}[${o}]`,n[o]);else if(null===(o=n)||"function"!=typeof o&&"object"!=typeof o)this.changeNode(t,e,n);else for(const o in n)n.hasOwnProperty(o)&&this.changeNode(t,`${e}.${o}`,n[o])}getElementByAttribute(t){if(!t.attributes)return[];for(let e=0;e<t.attributes.length;e++)if(/[A-Za-z0-9]{3}-[A-Za-z0-9]{6}/gm.test(t.attributes[e].nodeName||t.attributes[e].name))return[t.attributes[e]]}update(t,e){const n=document.createTreeWalker(this.$parent,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>NodeFilter.FILTER_ACCEPT},!1);for(;n.nextNode();)!0===n.currentNode.$init?this.updateNode(n.currentNode,t,e):this.setNode(n.currentNode,t,e);return this.$parent}}class d{constructor(t){this.$parent=t,this.$tree=new l(this.$parent)}update(t,e){this.$tree.update(t,e),this.$parent.onUpdate&&this.$parent.onUpdate()}}class h{constructor(t){this.$parent=t}set(t,e,n){const o=new RegExp(s).exec(n),r=!(!o||!o[2])&&o[2],i={[e]:{previousValue:t[e],newValue:n}};return r&&t.parentNode&&t.parentNode.host&&"open"===t.parentNode.mode?t[e]=u(t.parentNode.host,r):r&&t.parentNode?t[e]=u(t.parentNode,r):t[e]=n,this.$parent.$$state[a].update(e,t[e]),t.onStateChange&&t.onStateChange(i),!0}}function p(){this.bindState&&this.bindState()}function m(t,e){!function(t,e,n){const o=e.split("."),s=o.length;for(let e=0;e<s-1;e++){const n=o[e];t[n]||(t[n]={}),t=t[n]}t[o[s-1]]=n}(this.$state,t,e)}class f extends HTMLElement{constructor(){super(),function(t,e){const n=t.attachShadow(e||{}),o=document.createElement("template");o.innerHTML=t.template,n.appendChild(o.content.cloneNode(!0)),t.bindTemplate()}(this,{mode:"open"}),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}return t.MyCounter=class extends f{constructor(){super(...arguments),this.c="0"}connectedCallback(){this.shadowRoot.querySelector("#inc").addEventListener("click",this.inc.bind(this)),this.shadowRoot.querySelector("#dec").addEventListener("click",this.dec.bind(this))}get count(){return Number.parseInt(this.c)}inc(){this.setState("c",this.count+1)}dec(){this.setState("c",this.count-1)}getState(){return{c:this.c||"0"}}},e([function(t,e,n){function o(){this.$$state=this[e](),this.$$state[c]=new h(this),this.$$state[a]=new d(this.shadowRoot?this.shadowRoot:this),this.$state=Object.assign(new Proxy(this,this.$$state[c]),this[e]())}t.bindState=function(){o.call(this)}}],t.MyCounter.prototype,"getState",null),t.MyCounter=e([function(t){if(t)return e=>(function(t,e){t.style||(t.style=""),t.template||(t.template=""),e.prototype.elementMeta=Object.assign(e.elementMeta?e.elementMeta:{},t),e.prototype.elementMeta.eventMap={},e.prototype.template=`<style>${t.style}</style>${t.template}`,e.prototype.bindTemplate=p,e.prototype.setState=m}(t,e),void 0===t.autoDefine&&(t.autoDefine=!0),!0===t.autoDefine&&(t.selector&&!t.custom?customElements.define(t.selector,e):t.selector&&t.custom?customElements.define(t.selector,e,t.custom):customElements.define(t.selector,e)),e);console.error("Component must include ElementMeta to compile")}({selector:"my-counter",template:'\n    <button id="dec">-</button>\n    <span>{{c}}</span>\n    <button id="inc">+</button>\n  ',style:"\n\tspan,\n\tbutton {\n\t\tfont-size: 200%;\n\t}\n\n\tspan {\n\t\twidth: 4rem;\n\t\tdisplay: inline-block;\n\t\ttext-align: center;\n\t}\n\n\tbutton {\n\t\twidth: 4rem;\n\t\theight: 4rem;\n\t\tborder: none;\n\t\tborder-radius: 10px;\n\t\tbackground-color: seagreen;\n\t\tcolor: white;\n\t}\n\t"})],t.MyCounter),t}({});
