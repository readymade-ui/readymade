var app=function(e){"use strict";function t(e,t,n,s){var o,l=arguments.length,i=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(l<3?o(i):l>3?o(t,n,i):o(t,n))||i);return l>3&&i&&Object.defineProperty(t,n,i),i}class n{constructor(e){this.target=e,this.channels={default:new BroadcastChannel("default")},this.events={}}get(e){return this.events[e]}set(e,t){return this.events[e]=t,this.get(e)}emit(e){"string"==typeof e&&(e=this.events[e]),this.target.dispatchEvent(e)}broadcast(e,t){"string"==typeof e&&(e=this.events[e]),this.target.dispatchEvent(e),null===(e={type:e.type,detail:e.detail}).detail&&delete e.detail,t?this.channels[t].postMessage(e):this.channels.default.postMessage(e)}setChannel(e){this.channels[e]=new BroadcastChannel(e)}removeChannel(e){this.channels[e].close(),delete this.channels[e]}}function s(){const e=function e(t,n=[],s=[]){t.children.length||s.push(n.concat(t));for(const o of t.children)e(o,n.concat(o),s);return s}(this,[]).reduce((e,t)=>e.concat(t),[]);return e.filter((t,n)=>e.indexOf(t)>=n)}const o=/\{\{(\s*)(.*?)(\s*)\}\}/g,l=" __state";Object.byString=function(e,t){if(!t)return e;for(var n=(t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),s=0,o=n.length;s<o;++s){var l=n[s];if(!(l in e))return;e=e[l]}return e};class i{constructor(e){this.template=e.innerHTML,this.node=e}update(e){let t=this.template.slice(0);this.node.innerHTML=t.replace(o,(t,n)=>Object.byString(e,/\{\{(\s*)(.*?)(\s*)\}\}/.exec(t)[2])||"")}}class a{constructor(e){this.model=e}set(e,t,n){return e[t]=n,this.model.elementMeta.boundState["node"+l].update(this.model),!0}}function c(){this.elementMeta||(this.elementMeta={}),this.elementMeta.templateRegex=o,this.elementMeta.boundState={["node"+l]:new i(this),["handler"+l]:new a(this)},this.state=new Proxy(this,this.elementMeta.boundState["handler"+l])}function r(){this.elementMeta||(this.elementMeta={}),this.elementMeta.boundNodes=this.getChildNodes().map(e=>(e.elementMeta||(e.elementMeta={}),e.elementMeta.templateRegex=o,e.elementMeta.boundState={["node"+l]:new i(e),["handler"+l]:new a(e)},e.state=new Proxy(e,e.elementMeta.boundState["handler"+l]),e))}const h=()=>{};class p extends HTMLButtonElement{constructor(){super(),function(e,t){const n=document.createElement("template");n.innerHTML=e.elementMeta.template,e.appendChild(n.content.cloneNode(!0)),e.bindTemplate()}(this),function(e,t){const n=`${e.elementMeta.selector}`;if(!document.getElementById(`${n}-x`)){const t=document.createElement("style");t.setAttribute("id",`${n}-x`),t.innerText=e.elementMeta.style,t.innerText=t.innerText.replace(/:host/gi,`[is=${n}]`),document.head.appendChild(t)}}(this),this.onInit&&this.onInit()}}var u,d;return e.MyButtonComponent=class extends p{constructor(){super(),this.state.model="Click"}onClick(e){console.log("click")}},t([(u="click",function(e,t,s){const{onInit:o=h,onDestroy:l=h}=e,i=Symbol(t);e.onInit=function(){o.call(this),function(){const e=this[i]=((...e)=>{s.value.apply(this,e)});this.emitter||(this.emitter=new n(this),d&&(this.elementMeta.eventMap[u]={key:u,handler:t},this.emitter.channels[d].onmessage=(e=>{this[this.elementMeta.eventMap[u].handler](e.data)}))),this.addEventListener(u,e)}.call(this)},e.onDestroy=function(){l.call(this),function(){this.removeEventListener(u,this[i])}.call(this)}})],e.MyButtonComponent.prototype,"onClick",null),e.MyButtonComponent=t([function(e){if(e)return t=>(function(e,t){t.prototype.elementMeta=Object.assign({},e),t.prototype.elementMeta.eventMap={},t.prototype.template=document.createElement("template"),t.prototype.template=`<style>${e.style}</style>${e.template}`,t.prototype.getChildNodes=s,t.prototype.bindTemplateNodes=r,t.prototype.bindTemplate=c}(e,t),t);console.error("Component must include ElementMeta to compile")}({selector:"my-button",template:((...e)=>e)`{{model}}`,style:((...e)=>e)`:host{background:#181818;cursor:pointer;color:#fff;font-weight:400}`})],e.MyButtonComponent),customElements.define("my-button",e.MyButtonComponent,{extends:"button"}),e}({});
//# sourceMappingURL=main.js.map
