class EventDispatcher{constructor(t){this.target=t,this.channels={default:new BroadcastChannel("default")},this.events={}}get(t){return this.events[t]}set(t,e){return this.events[t]=e,this.get(t)}emit(t){"string"==typeof t&&(t=this.events[t]),this.target.dispatchEvent(t)}broadcast(t,e){"string"==typeof t&&(t=this.events[t]),this.target.dispatchEvent(t),null===(t={type:t.type,detail:t.detail}).detail&&delete t.detail,e?this.channels[e].postMessage(t):this.channels.default.postMessage(t)}setChannel(t){this.channels[t]=new BroadcastChannel(t)}removeChannel(t){this.channels[t].close(),delete this.channels[t]}}function attachShadow(t,e){const n=t.attachShadow(e||{}),o=document.createElement("template");o.innerHTML=t.template,n.appendChild(o.content.cloneNode(!0)),t.bindTemplate()}function attachDOM(t,e){const n=document.createElement("template");n.innerHTML=t.elementMeta.template,t.appendChild(n.content.cloneNode(!0)),t.bindTemplate()}function attachStyle(t,e){const n=`${t.elementMeta.selector}`;if(!document.getElementById(`${n}-x`)){const e=document.createElement("style");e.setAttribute("id",`${n}-x`),e.innerText=t.elementMeta.style,e.innerText=e.innerText.replace(/:host/gi,`[is=${n}]`),document.head.appendChild(e)}}function getParent(t){return t.parentNode}function getChildNodes(){const t=function t(e,n=[],o=[]){e.children.length||o.push(n.concat(e));for(const s of e.children)t(s,n.concat(s),o);return o}(this,[]).reduce((t,e)=>t.concat(e),[]);return t.filter((e,n)=>t.indexOf(e)>=n)}function getSiblings(t,e){return e||(e=[]),Array.from(getParent(t).children).filter(t=>"TEXT"!==t.tagName&&"STYLE"!==t.tagName)}function querySelector(t){return document.querySelector(t)}function querySelectorAll(t){return Array.from(document.querySelectorAll(t))}function getElementIndex(t){return getSiblings(t).indexOf(t)}const TEMPLATE_BIND_REGEX=/\{\{(\s*)(.*?)(\s*)\}\}/g,BIND_SUFFIX=" __state";Object.byString=function(t,e){if(!e)return t;for(var n=(e=(e=e.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),o=0,s=n.length;o<s;++o){var i=n[o];if(!(i in t))return;t=t[i]}return t};class BoundNode{constructor(t){this.template=t.innerHTML,this.node=t}update(t){let e=this.template.slice(0);this.node.innerHTML=e.replace(TEMPLATE_BIND_REGEX,(e,n)=>Object.byString(t,/\{\{(\s*)(.*?)(\s*)\}\}/.exec(e)[2])||"")}}class BoundHandler{constructor(t){this.model=t}set(t,e,n){return t[e]=n,this.model.elementMeta.boundState["node"+BIND_SUFFIX].update(this.model),!0}}function bindTemplate(){this.elementMeta||(this.elementMeta={}),this.elementMeta.templateRegex=TEMPLATE_BIND_REGEX,this.elementMeta.boundState={["node"+BIND_SUFFIX]:new BoundNode(this),["handler"+BIND_SUFFIX]:new BoundHandler(this)},this.state=new Proxy(this,this.elementMeta.boundState["handler"+BIND_SUFFIX])}function bindTemplateNodes(){this.elementMeta||(this.elementMeta={}),this.elementMeta.boundNodes=this.getChildNodes().map(t=>(t.elementMeta||(t.elementMeta={}),t.elementMeta.templateRegex=TEMPLATE_BIND_REGEX,t.elementMeta.boundState={["node"+BIND_SUFFIX]:new BoundNode(t),["handler"+BIND_SUFFIX]:new BoundHandler(t)},t.state=new Proxy(t,t.elementMeta.boundState["handler"+BIND_SUFFIX]),t))}function compileTemplate(t,e){e.prototype.elementMeta=Object.assign({},t),e.prototype.elementMeta.eventMap={},e.prototype.template=document.createElement("template"),e.prototype.template=`<style>${t.style}</style>${t.template}`,e.prototype.getChildNodes=getChildNodes,e.prototype.bindTemplateNodes=bindTemplateNodes,e.prototype.bindTemplate=bindTemplate}const html=(...t)=>t,css=(...t)=>t,noop=()=>{};function Component(t){if(t)return e=>(compileTemplate(t,e),e);console.error("Component must include ElementMeta to compile")}function Emitter(t,e){return function(n,o,s){const{onInit:i=noop}=n;n.onInit=function(){i.call(this),function(){this.emitter||(this.emitter=new EventDispatcher(this)),this.emitter.set(t,new CustomEvent(t,e||{}))}.call(this)}}}function Listen(t,e){return function(n,o,s){const{onInit:i=noop,onDestroy:a=noop}=n,c=Symbol(o);n.onInit=function(){i.call(this),function(){const n=this[c]=((...t)=>{s.value.apply(this,t)});this.emitter||(this.emitter=new EventDispatcher(this),e&&(this.elementMeta.eventMap[t]={key:t,handler:o},this.emitter.channels[e].onmessage=(e=>{this[this.elementMeta.eventMap[t].handler](e.data)}))),this.addEventListener(t,n)}.call(this)},n.onDestroy=function(){a.call(this),function(){this.removeEventListener(t,this[c])}.call(this)}}}class StructuralElement extends HTMLElement{constructor(){super(),this.onInit&&this.onInit()}}class PseudoElement extends HTMLElement{constructor(){super(),attachDOM(this),attachStyle(this),this.onInit&&this.onInit()}}class CustomElement extends HTMLElement{constructor(){super(),attachShadow(this,{mode:"open"}),this.onInit&&this.onInit()}}class AllCollectionComponent extends HTMLAllCollection{constructor(){super(),this.onInit&&this.onInit()}}class AnchorComponent extends HTMLAnchorElement{constructor(){super(),attachDOM(this),attachStyle(this),this.onInit&&this.onInit()}}class AreaComponent extends HTMLAreaElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}class AudioComponent extends HTMLAudioElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}class BRComponent extends HTMLBRElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}class BodyComponent extends HTMLBodyElement{constructor(){super(),attachShadow(this,{mode:"open"}),this.onInit&&this.onInit()}}class ButtonComponent extends HTMLButtonElement{constructor(){super(),attachDOM(this),attachStyle(this),this.onInit&&this.onInit()}}class CanvasComponent extends HTMLCanvasElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}class CollectionComponent extends HTMLCollection{constructor(){super(),this.onInit&&this.onInit()}}class ContentComponent extends HTMLContentElement{constructor(){super(),this.onInit&&this.onInit()}}class DListComponent extends HTMLDListElement{constructor(){super(),attachDOM(this),attachStyle(this),this.onInit&&this.onInit()}}class DataComponent extends HTMLDataElement{constructor(){super(),this.onInit&&this.onInit()}}class DataListComponent extends HTMLDataListElement{constructor(){super(),attachDOM(this),attachStyle(this),this.onInit&&this.onInit()}}class DetailsComponent extends HTMLDetailsElement{constructor(){super(),attachDOM(this),attachStyle(this),this.onInit&&this.onInit()}}class DialogComponent extends HTMLDialogElement{constructor(){super(),attachDOM(this),attachStyle(this),this.onInit&&this.onInit()}}class DivComponent extends HTMLDivElement{constructor(){super(),attachShadow(this,{mode:"open"}),this.onInit&&this.onInit()}}class EmbedComponent extends HTMLEmbedElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}class FieldSetComponent extends HTMLFieldSetElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}class FormControlsComponent extends HTMLFormControlsCollection{constructor(){super(),this.onInit&&this.onInit()}}class FormComponent extends HTMLFormElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}class HRComponent extends HTMLHRElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}class HeadComponent extends HTMLHeadElement{constructor(){super(),this.onInit&&this.onInit()}}class HeadingComponent extends HTMLHeadingElement{constructor(){super(),attachShadow(this,{mode:"open"}),this.onInit&&this.onInit()}}class HtmlComponent extends HTMLHtmlElement{constructor(){super(),this.onInit&&this.onInit()}}class IFrameComponent extends HTMLIFrameElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}class ImageComponent extends HTMLImageElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}class InputComponent extends HTMLInputElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}class LIComponent extends HTMLLIElement{constructor(){super(),attachDOM(this),attachStyle(this),this.onInit&&this.onInit()}}class LabelComponent extends HTMLLabelElement{constructor(){super(),attachDOM(this),attachStyle(this),this.onInit&&this.onInit()}}class LegendComponent extends HTMLLegendElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}class LinkComponent extends HTMLLinkElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}class MapComponent extends HTMLMapElement{constructor(){super(),attachDOM(this),attachStyle(this),this.onInit&&this.onInit()}}class MediaComponent extends HTMLMediaElement{constructor(){super(),this.onInit&&this.onInit()}}class MenuComponent extends HTMLMenuElement{constructor(){super(),this.onInit&&this.onInit()}}class MetaComponent extends HTMLMetaElement{constructor(){super(),this.onInit&&this.onInit()}}class MeterComponent extends HTMLMeterElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}class ModComponent extends HTMLModElement{constructor(){super(),this.onInit&&this.onInit()}}class OListComponent extends HTMLOListElement{constructor(){super(),attachDOM(this),attachStyle(this),this.onInit&&this.onInit()}}class ObjectComponent extends HTMLObjectElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}class OptGroupComponent extends HTMLOptGroupElement{constructor(){super(),this.onInit&&this.onInit()}}class OptionComponent extends HTMLOptionElement{constructor(){super(),this.onInit&&this.onInit()}}class OptionsCollectionComponent extends HTMLOptionsCollection{constructor(){super(),this.onInit&&this.onInit()}}class OutputComponent extends HTMLOutputElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}class ParagraphComponent extends HTMLParagraphElement{constructor(){super(),attachShadow(this,{mode:"open"}),this.onInit&&this.onInit()}}class ParamComponent extends HTMLParamElement{constructor(){super(),this.onInit&&this.onInit()}}class PictureComponent extends HTMLPictureElement{constructor(){super(),this.onInit&&this.onInit()}}class PreComponent extends HTMLPreElement{constructor(){super(),this.onInit&&this.onInit()}}class ProgressComponent extends HTMLProgressElement{constructor(){super(),this.onInit&&this.onInit()}}class QuoteComponent extends HTMLQuoteElement{constructor(){super(),this.onInit&&this.onInit()}}class ScriptComponent extends HTMLScriptElement{constructor(){super(),this.onInit&&this.onInit()}}class SelectComponent extends HTMLSelectElement{constructor(){super(),this.onInit&&this.onInit()}}class ShadowComponent extends HTMLShadowElement{constructor(){super(),this.onInit&&this.onInit()}}class SlotComponent extends HTMLSlotElement{constructor(){super(),this.onInit&&this.onInit()}}class SourceComponent extends HTMLSourceElement{constructor(){super(),this.onInit&&this.onInit()}}class SpanComponent extends HTMLSpanElement{constructor(){super(),attachShadow(this,{mode:"open"}),this.onInit&&this.onInit()}}class StyleComponent extends HTMLStyleElement{constructor(){super(),this.onInit&&this.onInit()}}class TableCaptionComponent extends HTMLTableCaptionElement{constructor(){super(),this.onInit&&this.onInit()}}class TableCellComponent extends HTMLTableCellElement{constructor(){super(),this.onInit&&this.onInit()}}class TableColComponent extends HTMLTableColElement{constructor(){super(),this.onInit&&this.onInit()}}class TableComponent extends HTMLTableElement{constructor(){super(),attachDOM(this),attachStyle(this),this.onInit&&this.onInit()}}class TableRowComponent extends HTMLTableRowElement{constructor(){super(),attachDOM(this),attachStyle(this),this.onInit&&this.onInit()}}class TableSectionComponent extends HTMLTableSectionElement{constructor(){super(),attachDOM(this),attachStyle(this),this.onInit&&this.onInit()}}class TemplateComponent extends HTMLTemplateElement{constructor(){super(),this.onInit&&this.onInit()}}class TimeComponent extends HTMLTimeElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}class TitleComponent extends HTMLTitleElement{constructor(){super(),this.onInit&&this.onInit()}}class TrackComponent extends HTMLTrackElement{constructor(){super(),this.onInit&&this.onInit()}}class UListComponent extends HTMLUListElement{constructor(){super(),attachDOM(this),attachStyle(this),this.onInit&&this.onInit()}}class UnknownComponent extends HTMLUnknownElement{constructor(){super(),this.onInit&&this.onInit()}}class VideoComponent extends HTMLVideoElement{constructor(){super(),attachStyle(this),this.onInit&&this.onInit()}}export{EventDispatcher,attachDOM,attachStyle,attachShadow,getSiblings,getElementIndex,getParent,querySelector,querySelectorAll,getChildNodes,bindTemplate,bindTemplateNodes,compileTemplate,Component,Emitter,Listen,html,css,noop,StructuralElement,PseudoElement,CustomElement,AllCollectionComponent,AnchorComponent,AreaComponent,AudioComponent,BRComponent,BodyComponent,ButtonComponent,CanvasComponent,CollectionComponent,ContentComponent,DListComponent,DataComponent,DataListComponent,DetailsComponent,DialogComponent,DivComponent,EmbedComponent,FieldSetComponent,FormControlsComponent,FormComponent,HRComponent,HeadComponent,HeadingComponent,HtmlComponent,IFrameComponent,ImageComponent,InputComponent,LIComponent,LabelComponent,LegendComponent,LinkComponent,MapComponent,MediaComponent,MenuComponent,MetaComponent,MeterComponent,ModComponent,OListComponent,ObjectComponent,OptGroupComponent,OptionComponent,OptionsCollectionComponent,OutputComponent,ParagraphComponent,ParamComponent,PictureComponent,PreComponent,ProgressComponent,QuoteComponent,ScriptComponent,SelectComponent,ShadowComponent,SlotComponent,SourceComponent,SpanComponent,StyleComponent,TableCaptionComponent,TableCellComponent,TableColComponent,TableComponent,TableRowComponent,TableSectionComponent,TemplateComponent,TimeComponent,TitleComponent,TrackComponent,UListComponent,UnknownComponent,VideoComponent};
//# sourceMappingURL=core.min.js.map
