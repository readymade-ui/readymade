class t{constructor(t,e){this.target=t,this.channels={default:new BroadcastChannel("default")},e&&this.setChannel(e),this.events={}}get(t){return this.events[t]}set(t,e){return this.events[t]=e,this.get(t)}emit(t){"string"==typeof t&&(t=this.events[t]),this.target.dispatchEvent(t)}broadcast(t,e){"string"==typeof t&&(t=this.events[t]),this.target.dispatchEvent(t);const n={bubbles:t.bubbles,cancelBubble:t.cancelBubble,cancelable:t.cancelable,defaultPrevented:t.defaultPrevented,detail:t.detail,timeStamp:t.timeStamp,type:t.type};e?this.channels[e].postMessage(n):this.channels.default.postMessage(n)}setChannel(t){this.channels[t]=new BroadcastChannel(t),this.channels[t].onmessage=e=>{for(const n in this.target.elementMeta.eventMap)n.includes(t)&&n.includes(e.data.type)&&this.target[this.target.elementMeta.eventMap[n].handler](e.data)}}removeChannel(t){this.channels[t].close(),delete this.channels[t]}}function e(t,e){const n=t.attachShadow(e||{}),s=document.createElement("template");s.innerHTML=t.template,n.appendChild(s.content.cloneNode(!0)),t.bindTemplate()}function n(t,e){const n=document.createElement("template");n.innerHTML=t.elementMeta.template,t.appendChild(n.content.cloneNode(!0)),t.bindTemplate()}function s(t,e){const n=""+t.elementMeta.selector;if(!document.getElementById(n+"-x")){const e=document.createElement("style");e.setAttribute("id",n+"-x"),e.innerText=t.elementMeta.style,e.innerText=e.innerText.replace(/:host/gi,`[is=${n}]`),document.head.appendChild(e)}}function i(t,e){!0===e.autoDefine&&(e.selector&&!e.custom?customElements.define(e.selector,t.contructor):e.selector&&e.custom?customElements.define(e.selector,t.contructor,e.custom):(console.log(e.selector,t.constructor),customElements.define(e.selector,t.contructor)))}const o=/\[(\w+)\]/g,r=/^\./,a=/\.|\[[0-9]*\]|(?:\['|'\])/g,c=/\{\{(\s*)(.*?)(\s*)\}\}/g,l=new RegExp("\\[","g"),u=new RegExp("\\]","g"),h=new RegExp("{{"),d=new RegExp("}}"),m=function(t,e){const n=(e=(e=e.replace(o,".$1")).replace(r,"")).split(a).filter((t=>t.length>0));for(let e=0,s=n.length;e<s;++e){const s=n[e];if(!(s in t))return;t=t[s]}return t};function f(t){return t=(t=t.replace(h,"")).replace(d,"")}class p{constructor(t){this.$flatMap={},this.$parent=t,this.$flatMap={},this.$parentId=function(){let t="";const e="abcdefghijklmnopqrstuvwxyz";for(;t.length<3;)t+=e[Math.floor(Math.random()*e.length)];return t}()}setNode(t,e,n,s){if(this.$flatMap[s])return this.$flatMap[s];const i=s||this.$parentId+"-"+"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(24)})).slice(0,6),o=t.cloneNode(!0);return t.setAttribute||(t.setAttribute=function(t,e){}),t.setAttribute(i,""),o.setAttribute||(o.setAttribute=function(t,e){}),o.setAttribute(i,""),this.$flatMap[i]={id:i,node:o},t.$init=!0,this.$flatMap[i]}changeNode(t,e,n,s){const i=function(t){return new RegExp(`{{(\b*)(${t})(\b*)}}`,"g")}(e=function(t){return(t=t.replace(l,"\\[")).replace(u,"\\]")}(e));if(s.textContent.match(i)&&s.textContent===`{{${e}}}`&&t.textContent!==n&&(t.textContent=s.textContent.replace(i,n)),1===s.attributes.length)return;let o="";for(const e of s.attributes){if(o=e.nodeName||e.name,o.includes("attr.")&&!s.getAttribute(o.replace("attr.",""))){e.nodeName?o=e.nodeName.replace("attr.",""):e.name&&(o=e.name.replace("attr.","")),s.setAttribute||(s.setAttribute=function(t,e){}),s.setAttribute(o,e.nodeValue.replace(c,""));const n=e.nodeName||e.name;t.removeAttribute(n)}const r=e.nodeValue||e.value;r.match(i,"gi")&&t.getAttribute(o)!==n&&(t.setAttribute||(t.setAttribute=function(t,e){}),t.setAttribute(o,r.replace(i,n)));const a=e.nodeName||e.name;a.includes("attr.")&&t.removeAttribute(a)}}updateNode(t,e,n){const s=this.getElementByAttribute(t)[0],i=s?s.nodeName||s.name:null;let o=this.setNode(t,e,n,i).node,r=null;if(o.outerHTML&&(r=o.outerHTML.toString().match(c)),o._nodeValue&&(r=o._nodeValue.match(c)),null==r)return;for(let t=0;t<r.length;t++)r[t]=f(r[t]);let l=function(t,e){const n=[];for(let s=0;s<e.length;s++)t(e[s])&&n.push(e[s]);return n}((t=>t.startsWith(e)),r);var u;if(0!==l.length)if(null!==(u=n)&&("function"==typeof u||"object"==typeof u)||Array.isArray(n))for(let e=0;e<l.length;e++)this.changeNode(t,r[e],m(n,r[e].substring(r[e].search(a))),o);else this.changeNode(t,e,n,o)}getElementByAttribute(t){if(!t.attributes)return[];let e=[];for(let n=0;n<t.attributes.length;n++)/[A-Za-z0-9]{3}-[A-Za-z0-9]{6}/gm.test(t.attributes[n].nodeName||t.attributes[n].name)&&e.push(t.attributes[n]);return e}update(t,e){const n=document.createTreeWalker(this.$parent,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>NodeFilter.FILTER_ACCEPT},!1);for(;n.nextNode();)this.updateNode(n.currentNode,t,e);return this.$parent}}class b{constructor(t){this.$elem=t,this.$tree=new p(this.$elem)}update(t,e){null!=e&&(this.$tree.update(t,e),this.$elem.onUpdate&&this.$elem.onUpdate())}}class x{constructor(t){this.$parent=t}set(t,e,n){if("undefined"===n)return!0;const s=new RegExp(c).exec(n),i=!(!s||!s[2])&&s[2],o={[e]:{previousValue:t[e],newValue:n}};return i?t.parentNode&&t.parentNode.host&&"open"===t.parentNode.mode?t[e]=m(t.parentNode.host,i):i&&t.parentNode&&(t[e]=m(t.parentNode,i)):t[e]=n,this.$parent.ɵɵstate.node__state.update(e,t[e]),t.onStateChange&&t.onStateChange(o),!0}}function g(){this.bindState&&this.bindState()}function E(t,e){!function(t,e,n){const s=e.split(a),i=s.length;for(let e=0;e<i-1;e++){const n=s[e];t[n]||(t[n]={}),t=t[n]}t[s[i-1]]=n}(this.ɵstate,t,e),this.ɵɵstate.node__state.update(t,e)}function $(t,e){t.style||(t.style=""),t.template||(t.template=""),e.prototype.elementMeta=Object.assign(e.elementMeta?e.elementMeta:{},t),e.prototype.elementMeta.eventMap={},e.prototype.template=`<style>${t.style}</style>${t.template}`,e.prototype.bindTemplate=g,e.prototype.setState=E}function y(t){return t.parentNode}function M(t){const e=t||this;if(!e)return[];const n=function t(e,n=[],s=[]){e.children.length||s.push(n.concat(e));for(const i of e.children)t(i,n.concat(i),s);return s}(e,[]).reduce(((t,e)=>t.concat(e)),[]);return n.filter(((t,e)=>n.indexOf(t)>=e))}function N(t){return Array.from(y(t).children).filter((t=>"TEXT"!==t.tagName&&"STYLE"!==t.tagName))}function v(t){return document.querySelector(t)}function A(t){return Array.from(document.querySelectorAll(t))}function w(t){return N(t).indexOf(t)}function L(t,e,n,s){return new(n||(n=Promise))((function(i,o){function r(t){try{c(s.next(t))}catch(t){o(t)}}function a(t){try{c(s.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}c((s=s.apply(t,e||[])).next())}))}const C="$emit",T="$listen",S=(...t)=>t,_=(...t)=>t,I=()=>{};function R(t){if(t)return e=>($(t,e),void 0===t.autoDefine&&(t.autoDefine=!0),!0===t.autoDefine&&(t.selector&&!t.custom?customElements.define(t.selector,e):t.selector&&t.custom?customElements.define(t.selector,e,t.custom):customElements.define(t.selector,e)),e);console.error("Component must include ElementMeta to compile")}function H(t){return function(t,e,n){function s(){return L(this,void 0,void 0,(function*(){this.$state=this[e](),this.ɵɵstate={},this.ɵɵstate.handler__state=new x(this),this.ɵɵstate.node__state=new b(this.shadowRoot?this.shadowRoot:this),this.ɵstate=new Proxy(this.$state,this.ɵɵstate.handler__state);for(const t in this.$state)this.ɵstate[t]=this.$state[t]}))}t.bindState=function(){s.call(this)}}}function B(e,n,s){return function(i,o,r){const a=s||"default";let c="";function l(e,s){this.emitter||(this.emitter=new t(this,s)),e&&this.emitter.set(e,new CustomEvent(e,n||{})),s&&!this.emitter.channels[s]&&this.emitter.setChannel(s)}function u(){for(const t in this)t.includes("$emit")&&this[t].call(this)}c=e?"$emit"+a+e:"$emit"+a,i[c]||(i[c]=function(){l.call(this,e,s)}),i.bindEmitters=function(){u.call(this)}}}function V(e,n){return function(s,i,o){const r=Symbol(i);let a="";function c(e,n){const s=this[r]=(...t)=>{o.value.apply(this,t)};this.emitter||(this.emitter=new t(this,n||null)),this.elementMeta.eventMap[a]={key:e,handler:i},this.addEventListener(e,s)}function l(){this.removeEventListener(e,this[r])}function u(){for(const t in this)t.includes("$listen")&&this[t].onListener.call(this)}a=n?"$listen"+e+n:"$listen"+e,s[a]||(s[a]={},s[a].onListener=function(){c.call(this,e,n)},s[a].onDestroyListener=function(){l.call(this,e,n)}),s.bindListeners=function(){u.call(this)}}}function D(t){for(const e in t)e.includes("$listen")&&this[e].onListener.call(this)}function P(t){for(const e in t)e.includes("$emit")&&t[e].call(t)}class O extends HTMLElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class j extends HTMLElement{constructor(){super(),n(this),s(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class k extends HTMLElement{constructor(){super(),e(this,{mode:this.elementMeta.mode||"open"}),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}export{R as Component,k as CustomElement,C as EMIT_KEY,B as Emitter,t as EventDispatcher,T as LISTEN_KEY,V as Listen,j as PseudoElement,H as State,O as StructuralElement,n as attachDOM,e as attachShadow,s as attachStyle,P as bindEmitters,D as bindListeners,g as bindTemplate,$ as compileTemplate,_ as css,i as define,M as getChildNodes,w as getElementIndex,y as getParent,N as getSiblings,S as html,I as noop,v as querySelector,A as querySelectorAll};
//# sourceMappingURL=core.min.js.map
