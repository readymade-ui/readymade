"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class t{constructor(t,e){this.target=t,this.channels={default:new BroadcastChannel("default")},e&&this.setChannel(e),this.events={}}get(t){return this.events[t]}set(t,e){return this.events[t]=e,this.get(t)}emit(t){"string"==typeof t&&(t=this.events[t]),this.target.dispatchEvent(t)}broadcast(t,e){"string"==typeof t&&(t=this.events[t]),this.target.dispatchEvent(t);const s={bubbles:t.bubbles,cancelBubble:t.cancelBubble,cancelable:t.cancelable,defaultPrevented:t.defaultPrevented,detail:t.detail,timeStamp:t.timeStamp,type:t.type};e?this.channels[e].postMessage(s):this.channels.default.postMessage(s)}setChannel(t){this.channels[t]=new BroadcastChannel(t),this.channels[t].onmessage=e=>{for(const s in this.target.elementMeta.eventMap)s.includes(t)&&s.includes(e.data.type)&&this.target[this.target.elementMeta.eventMap[s].handler](e.data)}}removeChannel(t){this.channels[t].close(),delete this.channels[t]}}function e(t,e){const s=t.attachShadow(e||{}),n=document.createElement("template");n.innerHTML=t.template,s.appendChild(n.content.cloneNode(!0)),t.bindTemplate()}function s(t,e){const s=document.createElement("template");s.innerHTML=t.elementMeta.template,t.appendChild(s.content.cloneNode(!0)),t.bindTemplate()}function n(t,e){const s=""+t.elementMeta.selector;if(!document.getElementById(s+"-x")){const e=document.createElement("style");e.setAttribute("id",s+"-x"),e.innerText=t.elementMeta.style,e.innerText=e.innerText.replace(/:host/gi,`[is=${s}]`),document.head.appendChild(e)}}const i=/\[(\w+)\]/g,r=/^\./,o=/\{\{(\s*)(.*?)(\s*)\}\}/g,h=new RegExp("\\[","gi"),d=new RegExp("\\]","gi"),c=function(t,e){const s=(e=(e=e.replace(i,".$1")).replace(r,"")).split(".");for(let e=0,n=s.length;e<n;++e){const n=s[e];if(!(n in t))return;t=t[n]}return t};class m{constructor(t){this.$flatMap={},this.$parent=t,this.$flatMap={},this.$parentId=function(){let t="";const e="abcdefghijklmnopqrstuvwxyz";for(;t.length<3;)t+=e[Math.floor(Math.random()*e.length)];return t}()}setNode(t,e,s){const n=this.$parentId+"-"+"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(24)})).slice(0,6),i=t.cloneNode(!0);t.setAttribute||(t.setAttribute=function(t,e){}),t.setAttribute(n,""),i.setAttribute||(i.setAttribute=function(t,e){}),i.setAttribute(n,""),this.$flatMap[n]||(this.$flatMap[n]={id:n,node:i},e&&s&&this.updateNode(t,e,s)),t.$init=!0}changeNode(t,e,s){e=(e=e.replace(h,"\\[")).replace(d,"\\]");const n=new RegExp(`{{(s*)(${e})(s*)}}`,"gi"),i=this.getElementByAttribute(t)[0].nodeName||this.getElementByAttribute(t)[0].name,r=this.$flatMap[i].node;if(r.textContent.match(n)&&(t.textContent=r.textContent.replace(n,s)),1===r.attributes.length)return;let c;for(const e of r.attributes){if(c=e.nodeName||e.name,c.includes("attr.")&&!r.getAttribute(c.replace("attr.",""))){e.nodeName?c=e.nodeName.replace("attr.",""):e.name&&(c=e.name.replace("attr.","")),r.setAttribute||(r.setAttribute=function(t,e){}),r.setAttribute(c,e.nodeValue.replace(o,""));const s=e.nodeName||e.name;t.removeAttribute(s)}const i=e.nodeValue||e.value;i.match(n,"gi")&&(t.setAttribute||(t.setAttribute=function(t,e){}),t.setAttribute(c,i.replace(n,s)));const h=e.nodeName||e.name;h.includes("attr.")&&t.removeAttribute(h)}}updateNode(t,e,s){var n;if(0!==this.getElementByAttribute(t).length)if(Array.isArray(s))for(let n=0;n<s.length;n++)this.changeNode(t,`${e}[${n}]`,s[n]);else if(null===(n=s)||"function"!=typeof n&&"object"!=typeof n)this.changeNode(t,e,s);else for(const n in s)s.hasOwnProperty(n)&&this.changeNode(t,`${e}.${n}`,s[n])}getElementByAttribute(t){if(!t.attributes)return[];for(let e=0;e<t.attributes.length;e++)if(/[A-Za-z0-9]{3}-[A-Za-z0-9]{6}/gm.test(t.attributes[e].nodeName||t.attributes[e].name))return[t.attributes[e]]}update(t,e){const s=document.createTreeWalker(this.$parent,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>NodeFilter.FILTER_ACCEPT},!1);for(;s.nextNode();)!0===s.currentNode.$init?this.updateNode(s.currentNode,t,e):this.setNode(s.currentNode,t,e);return this.$parent}}class l{constructor(t){this.$parent=t,this.$tree=new m(this.$parent)}update(t,e){this.$tree.update(t,e),this.$parent.onUpdate&&this.$parent.onUpdate()}}class a{constructor(t){this.$parent=t}set(t,e,s){const n=new RegExp(o).exec(s),i=!(!n||!n[2])&&n[2],r={[e]:{previousValue:t[e],newValue:s}};return i&&t.parentNode&&t.parentNode.host&&"open"===t.parentNode.mode?t[e]=c(t.parentNode.host,i):i&&t.parentNode?t[e]=c(t.parentNode,i):t[e]=s,this.$parent.$$state["node __state"].update(e,t[e]),t.onStateChange&&t.onStateChange(r),!0}}function p(){this.bindState&&this.bindState()}function b(t,e){!function(t,e,s){const n=e.split("."),i=n.length;for(let e=0;e<i-1;e++){const s=n[e];t[s]||(t[s]={}),t=t[s]}t[n[i-1]]=s}(this.$state,t,e)}function u(t,e){t.style||(t.style=""),t.template||(t.template=""),e.prototype.elementMeta=Object.assign(e.elementMeta?e.elementMeta:{},t),e.prototype.elementMeta.eventMap={},e.prototype.template=`<style>${t.style}</style>${t.template}`,e.prototype.bindTemplate=p,e.prototype.setState=b}function E(t){return t.parentNode}function L(t){return Array.from(E(t).children).filter((t=>"TEXT"!==t.tagName&&"STYLE"!==t.tagName))}class x extends HTMLElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class I extends HTMLElement{constructor(){super(),s(this),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class M extends HTMLElement{constructor(){super(),e(this,{mode:"open"}),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class T extends HTMLAllCollection{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class C extends HTMLAnchorElement{constructor(){super(),s(this),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class f extends HTMLAreaElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class H extends HTMLAudioElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class g extends HTMLBRElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class $ extends HTMLBodyElement{constructor(){super(),e(this,{mode:"open"}),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class y extends HTMLButtonElement{constructor(){super(),s(this),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class S extends HTMLCanvasElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class N extends HTMLCollection{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class A extends HTMLDListElement{constructor(){super(),s(this),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class v extends HTMLDataElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class w extends HTMLDetailsElement{constructor(){super(),s(this),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class O extends HTMLDivElement{constructor(){super(),e(this,{mode:"open"}),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class P extends HTMLEmbedElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class B extends HTMLFieldSetElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class D extends HTMLFormControlsCollection{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class _ extends HTMLFormElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class R extends HTMLHRElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class F extends HTMLHeadElement{constructor(){super(),this.onInit&&this.onInit()}}class k extends HTMLHeadingElement{constructor(){super(),e(this,{mode:"open"}),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class j extends HTMLHtmlElement{constructor(){super(),this.onInit&&this.onInit()}}class U extends HTMLIFrameElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class V extends HTMLImageElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class q extends HTMLInputElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class z extends HTMLLIElement{constructor(){super(),s(this),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class Y extends HTMLLabelElement{constructor(){super(),s(this),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class G extends HTMLLegendElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class K extends HTMLLinkElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class Q extends HTMLMapElement{constructor(){super(),s(this),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class W extends HTMLMediaElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class Z extends HTMLMenuElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class X extends HTMLMetaElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class J extends HTMLMeterElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class tt extends HTMLModElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class et extends HTMLOListElement{constructor(){super(),s(this),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class st extends HTMLObjectElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class nt extends HTMLOptGroupElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class it extends HTMLOptionElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class rt extends HTMLOptionsCollection{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class ot extends HTMLOutputElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class ht extends HTMLParagraphElement{constructor(){super(),e(this,{mode:"open"}),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class dt extends HTMLParamElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class ct extends HTMLPictureElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class mt extends HTMLPreElement{constructor(){super(),s(this),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class lt extends HTMLProgressElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class at extends HTMLQuoteElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class pt extends HTMLScriptElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class bt extends HTMLSelectElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class ut extends HTMLSlotElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class Et extends HTMLSourceElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class Lt extends HTMLSpanElement{constructor(){super(),e(this,{mode:"open"}),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class xt extends HTMLStyleElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class It extends HTMLTableCaptionElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class Mt extends HTMLTableCellElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class Tt extends HTMLTableColElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class Ct extends HTMLTableElement{constructor(){super(),s(this),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class ft extends HTMLTableRowElement{constructor(){super(),s(this),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class Ht extends HTMLTableSectionElement{constructor(){super(),s(this),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class gt extends HTMLTemplateElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class $t extends HTMLTimeElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class yt extends HTMLTitleElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class St extends HTMLTrackElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class Nt extends HTMLUListElement{constructor(){super(),s(this),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class At extends HTMLUnknownElement{constructor(){super(),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}class vt extends HTMLVideoElement{constructor(){super(),n(this),this.bindEmitters&&this.bindEmitters(),this.bindListeners&&this.bindListeners(),this.onInit&&this.onInit()}}exports.AllCollectionComponent=T,exports.AnchorComponent=C,exports.AreaComponent=f,exports.AudioComponent=H,exports.BRComponent=g,exports.BodyComponent=$,exports.ButtonComponent=y,exports.CanvasComponent=S,exports.CollectionComponent=N,exports.Component=function(t){if(t)return e=>(u(t,e),void 0===t.autoDefine&&(t.autoDefine=!0),!0===t.autoDefine&&(t.selector&&!t.custom?customElements.define(t.selector,e):t.selector&&t.custom?customElements.define(t.selector,e,t.custom):customElements.define(t.selector,e)),e);console.error("Component must include ElementMeta to compile")},exports.CustomElement=M,exports.DListComponent=A,exports.DataComponent=v,exports.DetailsComponent=w,exports.DivComponent=O,exports.EMIT_KEY="$emit",exports.EmbedComponent=P,exports.Emitter=function(e,s,n){return function(i,r,o){const h=n||"default";let d="";function c(e,n){this.emitter||(this.emitter=new t(this,n)),e&&this.emitter.set(e,new CustomEvent(e,s||{})),n&&!this.emitter.channels[n]&&this.emitter.setChannel(n)}function m(){for(const t in this)t.includes("$emit")&&this[t].call(this)}d=e?"$emit"+h+e:"$emit"+h,i[d]||(i[d]=function(){c.call(this,e,n)}),i.bindEmitters=function(){m.call(this)}}},exports.EventDispatcher=t,exports.FieldSetComponent=B,exports.FormComponent=_,exports.FormControlsComponent=D,exports.HRComponent=R,exports.HeadComponent=F,exports.HeadingComponent=k,exports.HtmlComponent=j,exports.IFrameComponent=U,exports.ImageComponent=V,exports.InputComponent=q,exports.LIComponent=z,exports.LISTEN_KEY="$listen",exports.LabelComponent=Y,exports.LegendComponent=G,exports.LinkComponent=K,exports.Listen=function(e,s){return function(n,i,r){const o=Symbol(i);let h="";function d(e,s){const n=this[o]=(...t)=>{r.value.apply(this,t)};this.emitter||(this.emitter=new t(this,s||null)),this.elementMeta.eventMap[h]={key:e,handler:i},this.addEventListener(e,n)}function c(){this.removeEventListener(e,this[o])}function m(){for(const t in this)t.includes("$listen")&&this[t].onListener.call(this)}h=s?"$listen"+e+s:"$listen"+e,n[h]||(n[h]={},n[h].onListener=function(){d.call(this,e,s)},n[h].onDestroyListener=function(){c.call(this,e,s)}),n.bindListeners=function(){m.call(this)}}},exports.MapComponent=Q,exports.MediaComponent=W,exports.MenuComponent=Z,exports.MetaComponent=X,exports.MeterComponent=J,exports.ModComponent=tt,exports.OListComponent=et,exports.ObjectComponent=st,exports.OptGroupComponent=nt,exports.OptionComponent=it,exports.OptionsCollectionComponent=rt,exports.OutputComponent=ot,exports.ParagraphComponent=ht,exports.ParamComponent=dt,exports.PictureComponent=ct,exports.PreComponent=mt,exports.ProgressComponent=lt,exports.PseudoElement=I,exports.QuoteComponent=at,exports.ScriptComponent=pt,exports.SelectComponent=bt,exports.SlotComponent=ut,exports.SourceComponent=Et,exports.SpanComponent=Lt,exports.State=function(t){return function(t,e,s){function n(){this.$$state=this[e](),this.$$state["handler __state"]=new a(this),this.$$state["node __state"]=new l(this.shadowRoot?this.shadowRoot:this),this.$state=Object.assign(new Proxy(this,this.$$state["handler __state"]),this[e]())}t.bindState=function(){n.call(this)}}},exports.StructuralElement=x,exports.StyleComponent=xt,exports.TableCaptionComponent=It,exports.TableCellComponent=Mt,exports.TableColComponent=Tt,exports.TableComponent=Ct,exports.TableRowComponent=ft,exports.TableSectionComponent=Ht,exports.TemplateComponent=gt,exports.TimeComponent=$t,exports.TitleComponent=yt,exports.TrackComponent=St,exports.UListComponent=Nt,exports.UnknownComponent=At,exports.VideoComponent=vt,exports.attachDOM=s,exports.attachShadow=e,exports.attachStyle=n,exports.bindTemplate=p,exports.compileTemplate=u,exports.css=(...t)=>t,exports.getChildNodes=function(t){const e=t||this;if(!e)return[];const s=function t(e,s=[],n=[]){e.children.length||n.push(s.concat(e));for(const i of e.children)t(i,s.concat(i),n);return n}(e,[]).reduce(((t,e)=>t.concat(e)),[]);return s.filter(((t,e)=>s.indexOf(t)>=e))},exports.getElementIndex=function(t){return L(t).indexOf(t)},exports.getParent=E,exports.getSiblings=L,exports.html=(...t)=>t,exports.noop=()=>{},exports.querySelector=function(t){return document.querySelector(t)},exports.querySelectorAll=function(t){return Array.from(document.querySelectorAll(t))};
//# sourceMappingURL=core.min.js.map
